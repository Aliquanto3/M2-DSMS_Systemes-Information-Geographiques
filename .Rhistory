ComptePoint=read.csv(file = "TD6/ComptePoint.csv")
ComptePoint=read.csv(file = "TD6/ComptePoints.csv")
ComptePoint=read.csv(file = "TD6/ComptePoints.csv",sep=";")
ComptePoints=read.csv(file = "TD6/ComptePoints.csv",sep=";")
View(ComptePoints)
names(ComptesPoints)
names(ComptePoints)
X=ComptePoint$NUMPOINTS
mean(X)
sqrt(var(X))/mean(x)
sqrt(var(X))/mean(X)
table(X)
ppois(0:max(X),mean(X))
ppois(0:max(X),mean(X))*100
dpois(0:max(X),mean(X))
dpois(0:max(X),mean(X)) * sum(table(X))
Theo = dpois(0:max(X),mean(X)) * sum(table(X))
Chi2=sum((Theo-Obs)^2/Theo)
Obs=table(X)
Theo = dpois(0:max(X),mean(X)) * sum(table(X))
Chi2=sum((Theo-Obs)^2/Theo)
Obs
Theo
Obs
str(Obs)
Obs=matrix(table(X))
str(Obs)
Obs=data.frame(table(X))
str(Obs)
View(Obs)
Obs=data.frame(table(X))
str(Obs)
View(Obs)
for (i in 0:max(X)){
if (!i %in% Obs$X){
Obs[nrow(Obs) + 1,] = c(i,0)
}
}
View(Obs)
Obs$X=as.numeric(Obs$X)
Obs=data.frame(table(X))
str(Obs)
Obs$X=as.numeric(Obs$X)
for (i in 0:max(X)){
if (!i %in% Obs$X){
Obs[nrow(Obs) + 1,] = c(i,0)
}
}
View(Obs)
Theo
Obs=Obs[order(Obs$age),]
Obs=Obs[order(Obs$X),]
View(Obs)
ComptePoints=read.csv(file = "TD6/ComptePoints.csv",sep=";")
View(ComptePoints)
names(ComptePoints)
X=ComptePoint$NUMPOINTS
mean(X)
sqrt(var(X))/mean(X)
Obs=data.frame(table(X))
str(Obs)
View(Obs)
Obs$X=as.numeric(Obs$X)
for (i in 0:max(X)){
if (!i %in% Obs$X){
Obs[nrow(Obs) + 1,] = c(i,0)
}
}
Obs=Obs[order(Obs$X),]
#View(Obs)
Obs
Theo = dpois(0:max(X),mean(X)) * sum(table(X));Theo
Chi2=sum((Theo-Obs)^2/Theo)
Chi2=sum((Theo-Obs)^2/Theo);Chi2
Obs=Obs[order(Obs$X),]
#View(Obs)
Obs
J=length(Obs)
N=sum(table(X))
Theo = dpois(0:max(X),mean(X)) * N;Theo
Chi2=sum((Theo-Obs)^2/Theo);Chi2
qchisq(0.95,J)
Chi2=sum((Theo-Obs$Freq)^2/Theo);Chi2
qchisq(0.95,J)
1-pchisq(Chi2,J)
rectangle66=matrix(data = rep(NA,K*K),nrow=K,ncol=K)
K=6
rectangle66=matrix(data = rep(NA,K*K),nrow=K,ncol=K)
rectangleK=matrix(data = rep(NA,K*K),nrow=K,ncol=K)
View(rectangleK)
lambda=5
rpois(1,lambda)
coordx=runfi(3,0,1)
coordx=runif(3,0,1)
coordy=runif(3,0,1)
plot(coordx,coordy)
MatN=matrix(data = rpois(K*K,lambda),nrow=K,ncol=K)
MatN=matrix(data = rpois(K*K,lambda),nrow=K,ncol=K);MatN
set.seed(1)
coordX=NULL
coordY=NULL
for (i in 1:K){
for (j in 1:K){
coordX=c(coordX,runif(MatN[i,j],i-1))
coordY=c(coordY,runif(MatN[i,j],i-1))
}
}
K=6
lambda=3.5
MatN=matrix(data = rpois(K*K,lambda),nrow=K,ncol=K);MatN
set.seed(1)
coordX=NULL
coordY=NULL
for (i in 1:K){
for (j in 1:K){
coordX=c(coordX,runif(MatN[i,j],i-1,j))
coordY=c(coordY,runif(MatN[i,j],i-1,j))
}
}
plot(coordx,coordy)
set.seed(1)
K=6
lambda=3.5
MatN=matrix(data = rpois(K*K,lambda),nrow=K,ncol=K);MatN
coordX=NULL
coordY=NULL
for (i in 1:K){
for (j in 1:K){
coordX=c(coordX,runif(MatN[i,j],i-1,i))
coordY=c(coordY,runif(MatN[i,j],j-1,j))
}
}
plot(coordx,coordy)
plot(coordX,coordY)
library(statspat)
library(spatstat)
install.packages("spatstat")
#install.packages("spatstat")
library(spatstat)
rpoispp(3.5,win=owin(c(0,K),c(0,K)))
plot(rpoispp(3.5,win=owin(c(0,K),c(0,K))))
rectN=rpoispp(3.5,win=owin(c(0,K),c(0,K)))
plot(rectN)
?rpoispp
#Calcul Ripley
D=matrix(dist(c(coordX,coordY))) #sym et diagonale
image(D)
#Calcul Ripley
D=as.matrix(dist(c(coordX,coordY))) #sym et diagonale
image(D)
rayon=0.5
sort(D[1,])
sum(D[1,] > rayon)
sum(D[1,] < rayon)
?image
#Calcul Ripley
N=length(coordX)
D=as.matrix(dist(c(coordX,coordY))) #sym et diagonale
image(D)
rayon=0.5
sort(D[1,])
sum(D[1,] < rayon)
S=0
for (i in 1:N){
S=S+sum(D[i,]<rayon)
}
S
#Calcul Ripley
Surf=K*K
#Calcul Ripley
Surf=K*K
N=length(coordX)
D=as.matrix(dist(c(coordX,coordY))) #sym et diagonale
image(D)
rayon=0.5
sort(D[1,])
sum(D[1,] < rayon)
S=0
for (i in 1:N){
S=S+sum(D[i,]<rayon)
}
S
(Surf/(N*(N-1)))*S
pi
Resu=NULL
for (rayon in seq(0.01,2,0.01)){
S=0
for (i in 1:N){
S=S+sum(D[i,] < rayon)
Resu=c(Resu,(Surf/(N*(N-1)))*S
)
}
}
plot(seq(0.01,2,0.01),Resu)
Resu=NULL
for (rayon in seq(0.01,2,0.01)){
S=0
for (i in 1:N){
S=S+sum(D[i,] < rayon)
}
Resu=c(Resu,(Surf/(N*(N-1)))*S)
}
plot(seq(0.01,2,0.01),Resu)
plot(seq(0.01,2,0.01),Resu,pch=".")
lines(seq(0.01,2,0.01), pi*seq(0.01,2,0.01)^2,pch="+")
